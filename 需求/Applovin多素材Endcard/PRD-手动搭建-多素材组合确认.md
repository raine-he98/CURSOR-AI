### PRD：手动搭建（多素材 & 素材资产组合筛选确认）- 原型版

### 1. 背景与目标

| 项 | 说明 |
|---|---|
| 背景 | 投放素材/Endcard/CPP 组合需要按规则批量搭建与确认，减少人工配置成本。 |
| 目标 | 提供两步流程：第 1 步配置规则与分组上限；第 2 步生成组合清单并完成 CPP/Endcard/CreativeSet 命名确认与批量应用。 |
| 非目标 | 本 PRD 不包含后端接口/真实数据拉取/持久化提交，仅描述当前页面原型规则与交互。 |

### 2. 术语

| 术语 | 含义 |
|---|---|
| 规则行 | 第 1 页表格中的一行：产品名称 + Campaign + 搭建规则 + 资产配置。 |
| 可搭建素材数 | 第 1 页概览中展示的“已选可搭建素材数”，用于拆分素材分组。 |
| 素材分组上限 | 多素材时每组素材数量的上限（2~10）。 |
| 组 | 第 2 页中由“同一条规则行”拆分出的多行数据集合（树形结构）。 |

### 3. 页面信息总览

| 页面 | 页面标题 | 进入条件 | 主要产出 |
|---|---|---|---|
| 页面 1 | 手动搭建 | 默认进入 | 规则行列表 + 多素材分组上限 |
| 页面 2 | 素材资产组合筛选确认 | 页面 1 选择“多素材”且校验通过，点击下一步 | 按规则行与素材分组展开后的组合清单 |

---

### 4. 页面 1：手动搭建（规则配置）

#### 4.1 模块与字段（表格）

| 模块 | 字段/控件 | 类型 | 可选值/格式 | 默认值 | 说明 |
|---|---|---|---|---|---|
| 投放媒体 | 投放媒体 | 单选 | Facebook / Tiktok / AppLovin / Adwords / Unity | 以原型为准 | 仅 UI 展示。 |
| 搭建素材（概览） | 素材关联App | 文本列表 | 例：Tile01A / Tile01G | 固定展示 | 用于限制“产品名称”候选。 |
| 搭建素材（概览） | 已选素材数 | 文本 | 数字 | 固定展示 | 仅展示。 |
| 搭建素材（概览） | 已选可搭建素材数 | 文本列表 | 数字 | 固定展示 | 用于第 2 页分组拆分。 |
| 匹配规则 | 规则行表格 | 表格 | 序号/产品名称/Campaign/搭建规则/资产配置/操作 | 见 4.2 | 支持新增/删除与重排。 |
| 匹配规则 | 广告内素材数量 | 单选 | 单素材 / 多素材 | 多素材 | 控制是否出现“素材分组数量上限”。 |
| 匹配规则（多素材） | 素材分组数量上限 | 输入框 | 2~10 正整数 | 10 | 仅当“多素材”时显示，影响第 2 页拆分。 |

#### 4.2 规则行默认值与操作

| 项 | 规则 |
|---|---|
| 默认规则行 1 | 产品名称=Tile01A，Campaign=Campaign-01，搭建规则=规则-01，资产配置=配置-01 |
| 默认规则行 2 | 产品名称=Tile01A，Campaign=Campaign-01，搭建规则=规则-02，资产配置=配置-02 |
| 新增规则行 | 点击“+ 添加匹配规则”新增，默认值同规则行 1 |
| 删除规则行 | 从第 2 行起显示“删除”，第 1 行不可删除；删除后序号自动重排 |
| 产品名称候选 | 必须与“素材关联App”一致（示例：Tile01A/Tile01G） |

#### 4.3 校验规则（页面 1）

| 触发点 | 字段 | 规则 | 不通过时 |
|---|---|---|---|
| 点击“下一步”（多素材） | 素材分组数量上限 | 必填；2~10 正整数 | 阻止进入页面 2，并提示错误 |

---

### 5. 页面 2：素材资产组合筛选确认（组合清单）

#### 5.1 数据生成（拆分与组合）

| 项 | 规则 |
|---|---|
| 分组来源 | 对每条“规则行”，读取其产品名称对应的“已选可搭建素材数”作为 total |
| 拆分规则 | 以“素材分组数量上限 limit”对 total 拆分，如 total=13, limit=10 → 10 + 3 |
| 组合生成 | 每条规则行 × 其拆分后的每个分组 = 生成多行组合数据 |
| 分组展示 | 同一规则行拆出的多行作为一组（树形表格），组内第 1 行展示展开箭头 |
| 展开默认态 | 每次从页面 1 进入页面 2：默认各组为“展开态”（箭头向下，子行可见），再次点击可收起 |

#### 5.2 表格结构

| 列序号 | 列名 | 类型 | 说明 |
|---:|---|---|---|
| 1 | 展开 | 按钮 | 仅组内第 1 行显示箭头；折叠向右、展开向下；组头行有浅色底。 |
| 2 | 多选 | 复选框 | 表头提供全选；进入页面 2 默认全选所有行。 |
| 3 | 产品名称 | 文本 | 来自页面 1 规则行。 |
| 4 | Campaign | 文本 | 来自页面 1 规则行。 |
| 5 | 搭建规则 | 文本 | 来自页面 1 规则行。 |
| 6 | 资产配置 | 文本 | 来自页面 1 规则行。 |
| 7 | 素材名称 | 列表/滚动 | 同一格内纵向分行；格内可横向滚动看全名；左下角固定“共x条”。 |
| 8 | CPP | 单选 + 下拉 | 不指定/指定；指定时出现下拉；组头行有“应用至全部”。 |
| 9 | Endcard | 多选下拉 | 支持全选、pill 回显、必选校验；组头行有“应用至全部”。 |
| 10 | CreativeSet命名 | 文本 + 编辑 | 完整换行展示；右下角蓝色图标编辑/保存；Enter 保存、Esc 取消。 |

#### 5.3 素材名称展示规则

| 项 | 规则 |
|---|---|
| 展示 | 每个素材名一行（纵向分行） |
| 可视 | 单元格内部支持左右滚动条，查看超长全名 |
| 计数 | 单元格左下角固定“共x条”，x=该分组内素材数量；不随滚动移动 |

#### 5.4 CPP 选择规则

| 项 | 规则 |
|---|---|
| 模式选项 | 不指定CPP / 指定CPP（默认不指定） |
| 指定CPP展示 | 选择“指定CPP”后，下方出现下拉框，候选为该资产配置的 CPP 列表 |
| 单 CPP 默认 | 若该资产配置只有 1 个 CPP，则下拉框默认选中该 CPP |
| 组内应用 | 组头行提供“应用至全部”，点击后本组所有行 CPP 模式与下拉选中值同步为组头行 |
| 按钮位置 | CPP 单元格右下角 |

#### 5.5 Endcard 选择规则（多选下拉 + 回显）

| 项 | 规则 |
|---|---|
| 控件 | 自定义多选下拉（含全选、滚动列表） |
| 下拉内全选 | “全选”支持半选态（indeterminate） |
| 默认选择（≤10） | 若该资产配置 Endcard 数量 ≤ 10：默认全选，并在选择器内以 pill 平铺回显 |
| 默认选择（>10） | 若 Endcard 数量 > 10：默认不选，选择器 placeholder 显示“请选择” |
| 回显形式 | 已选项以 pill 平铺展示；每个 pill 带“×”可移除（不打开下拉） |
| 必选 | 点击“确认”时每行至少选 1 个 Endcard；不满足则该行选择器标红并阻止确认 |
| 组内应用 | 组头行提供“应用至全部”，点击后把组头行 Endcard 勾选同步到本组其他行（含回显与全选态） |
| 按钮位置 | Endcard 单元格右下角 |

#### 5.6 CreativeSet 命名

| 项 | 规则 |
|---|---|
| 命名风格 | 长命名，参考示例：`20251225_DCGrapeOrangeWoodChicken3step_farm1_...`（由页面 1 字段拼接生成） |
| 展示 | 表格内自动换行展示完整命名 |
| 编辑 | 单元格右下角蓝色图标（编辑/保存切换）；Enter 保存，Esc 取消 |

#### 5.7 校验规则（页面 2）

| 触发点 | 字段 | 规则 | 不通过时 |
|---|---|---|---|
| 点击“确认” | Endcard | 每行至少选 1 个 | 阻止确认、定位并高亮错误行选择器 |

---

### 6. 原型假设数据（资产配置）

| 资产配置 | Endcard 数量 | CPP 数量 | 说明 |
|---|---:|---:|---|
| 配置-01 | 8（≤10） | 1 | Endcard 默认全选；CPP 指定时默认选中唯一值 |
| 配置-02 | 12（>10） | 多个 | Endcard 默认请选择；CPP 通过下拉选择 |
| 配置-03 | 6（≤10） | 2 | Endcard 默认全选；CPP 下拉可选多个 |

---

### 7. 交互要点（清单）

| 功能 | 行为 |
|---|---|
| 页面切换 | 页面 1 → 页面 2：多素材且校验通过；页面 2 → 页面 1：上一页 |
| 树形展开 | 组头行点击箭头切换展开/收起；子行缩进显示 |
| 默认全选 | 进入页面 2 默认勾选全部行与表头全选 |
| CPP 应用至全部 | 组头行按钮将 CPP 模式与下拉值同步到组内其它行 |
| Endcard 应用至全部 | 组头行按钮将 Endcard 勾选同步到组内其它行 |
| Endcard pill 移除 | 点击 pill 的“×”取消该项，回显与全选态实时更新 |



